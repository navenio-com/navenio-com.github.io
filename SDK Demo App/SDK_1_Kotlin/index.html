
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.4">
    
    
      
        <title>Navenio SDK Kotlin - Navenio</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#navenio-sdk-kotlin" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Navenio" class="md-header__button md-logo" aria-label="Navenio" data-md-component="logo">
      
  <img src="../../nav-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Navenio
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Navenio SDK Kotlin
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Navenio" class="md-nav__button md-logo" aria-label="Navenio" data-md-component="logo">
      
  <img src="../../nav-logo.png" alt="logo">

    </a>
    Navenio
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome to Navenio Android documentation
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        SDK Demo App
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="SDK Demo App" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          SDK Demo App
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Navenio SDK Kotlin
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Navenio SDK Kotlin
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-api-for-navenio-sdk-and-mapbox-to-dependencies-in-buildgradle-module" class="md-nav__link">
    1) Add API for Navenio SDK and Mapbox to dependencies in build.gradle (module)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-artifactory-to-projects-buildgradle" class="md-nav__link">
    2) Add artifactory to project's build.gradle
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-navenio-manager" class="md-nav__link">
    Creating the Navenio Manager
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fetching-a-venue" class="md-nav__link">
    Fetching a venue
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-your-location" class="md-nav__link">
    Getting your location
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collecting-the-data" class="md-nav__link">
    Collecting the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-the-data" class="md-nav__link">
    Uploading the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deleting-the-data" class="md-nav__link">
    Deleting the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-data-summary" class="md-nav__link">
    Getting data summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listeners" class="md-nav__link">
    Listeners
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#login" class="md-nav__link">
    Login
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../SDK_2_Java/" class="md-nav__link">
        Navenio SDK Java
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-api-for-navenio-sdk-and-mapbox-to-dependencies-in-buildgradle-module" class="md-nav__link">
    1) Add API for Navenio SDK and Mapbox to dependencies in build.gradle (module)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-artifactory-to-projects-buildgradle" class="md-nav__link">
    2) Add artifactory to project's build.gradle
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-navenio-manager" class="md-nav__link">
    Creating the Navenio Manager
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fetching-a-venue" class="md-nav__link">
    Fetching a venue
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-your-location" class="md-nav__link">
    Getting your location
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collecting-the-data" class="md-nav__link">
    Collecting the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-the-data" class="md-nav__link">
    Uploading the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deleting-the-data" class="md-nav__link">
    Deleting the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-data-summary" class="md-nav__link">
    Getting data summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listeners" class="md-nav__link">
    Listeners
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#login" class="md-nav__link">
    Login
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="navenio-sdk-kotlin">Navenio SDK Kotlin</h1>
<p>Note that these instructions were created for the old sdk a while ago. Keeping in case we want to reuse some contents / structure when we create samples for the new sdk</p>
<p>The Navenio Android SDK provides an API for developers to create location aware apps for navigation inside buildings. </p>
<h2 id="setup">Setup</h2>
<h4 id="1-add-api-for-navenio-sdk-and-mapbox-to-dependencies-in-buildgradle-module">1) Add API for Navenio SDK and Mapbox to dependencies in build.gradle (module)</h4>
<p>It should look like this:</p>
<pre><code class="language-groovy">dependencies {
    api &quot;com.navenio.dcm:sdk:1.0.49_debug&quot;
    api 'com.mapbox.mapboxsdk:mapbox-android-sdk:8.0.1'
    // Rest of Your dependencies
}
</code></pre>
<h4 id="2-add-artifactory-to-projects-buildgradle">2) Add artifactory to project's build.gradle</h4>
<p>You'll need to add artifactory, jfrog plugin, build info extractor and jitpack repository to project's build.gradle for Navenio SDK to work. Here's how to do it:</p>
<pre><code class="language-groovy">dependencies {
        classpath &quot;org.jfrog.buildinfo:build-info-extractor-gradle:4.9.10&quot;
         ...
}

allprojects {
    repositories {
        ...
        maven { url &quot;https://jitpack.io&quot; }

    }
    apply plugin: 'com.jfrog.artifactory'
}

artifactory {
    contextUrl = artifactory_url
    resolve {
        // remote repo key at https://navenio.jfrog.io/navenio
        repoKey = 'gradle-dev'

        username = artifactory_username
        password = artifactory_password
        maven = true
    }
}
</code></pre>
<h2 id="creating-the-navenio-manager">Creating the Navenio Manager</h2>
<p>The first step in your code is to create an instance of the Navenio Manager: </p>
<pre><code class="language-kotlin">val navenioManager: DebugNavenioManager= NavenioManagerProvider.getInstance(this)
</code></pre>
<h2 id="fetching-a-venue">Fetching a venue</h2>
<p>With Navenio Manager crated, You can fetch maps with all the settings using fetchVenue command :</p>
<pre><code class="language-kotlin">  navenioManager.fetchVenue(&quot;naveniohq&quot;, object : FetchVenueListener {
            override fun onError(e: Throwable, cached: Venue?) {
                Timber.e(&quot;Error fetching the venue $e&quot;)
            }

            override fun onSuccess(venue: Venue) {
                Timber.d(&quot;Venue fetched successfully!&quot;)
            }
        })
</code></pre>
<p>After success, You'll receive Venue object. You can also use <code>navenioManager.fetchVenue("naveniohq")</code> without listener, but that way You won't have any control on the process.
When venue is already fetched, and You need to get venue object (e.g from different place in app), You can use <code>navenioManager.getVenue("naveniohq")</code>, so that You're not fetching all config files and zips from server,
but using venue object that is already saved locally.</p>
<h2 id="getting-your-location">Getting your location</h2>
<p>Create a listener to receive callbacks from the location engine when your position has changed:</p>
<pre><code class="language-kotlin"> val locationListener = object : LocationListenerAdapter() {
            override fun onLocationChange(location: Location) {
             when (location) {
                    is Location.IndoorLocation -&gt; {
                        // Location is inside the venue
                    }
                    is Location.GeoLocation -&gt; {
                        // Location is outside the venue
                    }
                }
            }
        }
</code></pre>
<p>This listener should be registered / unregistered in the <code>onResume</code> and <code>onPause</code> Android lifecycle callbacks:</p>
<pre><code class="language-kotlin"> override fun onResume(){
      navenioManager.addLocationListener(locationListener)
    }

 override fun onPause(){
     navenioManager.removeLocationListener()
    }
</code></pre>
<p>You can start or stop locating anywhere in Your code by using <code>navenioManager.startLocating(LocationModeRequest.IOD(venueID))</code> and <code>navenioManager.stopLocating()</code>.</p>
<h2 id="collecting-the-data">Collecting the data</h2>
<p>For data collection You'll just need to use <code>navenioManager.startSampling(ctrl: Ctrl, venue: Venue)</code>. You received venue object after You fetched venue, and ctrl is one of the venue fields.<br />
You can use <code>navenioManager.stopSampling()</code> anytime to stop current sampling session.
If You want to listen for sampling change events, consider using DCMLifecycleListener. Here's example:  </p>
<pre><code class="language-kotlin"> val lifecycleListener = object : DCMLifecycleListenerAdapter() {
            override fun onSamplingStateChange(event: SamplingChangeEvent, sessionId: String) {
                when(event){
                 SamplingChangeEvent.START -&gt;{
                    // Do something when sampling has started
                 }
                 SamplingChangeEvent.STOP -&gt;{
                    // Do something when sampling has stopped
                 }
              }
           }
       }
      navenioManager.addLifecycleListener(lifecycleListener)
</code></pre>
<p>Don't forget about removing lifecycle listener after You're finished!</p>
<h2 id="uploading-the-data">Uploading the data</h2>
<p>There are two ways for uploading the collected data, one is just using <code>navenioManager.upload()</code> as it is. You have no control over it, as upload just will run in the background.<br />
Second approach(recommended) is using upload method with upload listener. Here's example:</p>
<pre><code class="language-kotlin"> navenioManager.upload(FileUpload(), object : UploadListener {
            override fun onComplete() {
                Timber.d(&quot;Yay! Upload completed successfully&quot;)
            }

            override fun onError(e: Throwable) {
                Timber.e(&quot;Something's wrong $e&quot;)
            }

            override fun onProgress(currentIndex: Int, currentProgress: Int, max: Int) {
                Timber.d(&quot;Upload progress: $currentProgress&quot;)
            }

            override fun onUploadStarted(filesToUpload: List&lt;UploadFileSummary&gt;) {
                Timber.d(&quot;Upload started!&quot;)
            }
        })
</code></pre>
<h2 id="deleting-the-data">Deleting the data</h2>
<pre><code class="language-kotlin">// Delete all files
navenioManager.deleteAllFiles()

//Delete specific file
navenioManager.deleteFile(file: File)
</code></pre>
<h2 id="getting-data-summary">Getting data summary</h2>
<pre><code class="language-kotlin">// Receive number of files ready to upload 
navenioManager.getNumberOfFiles()

// Receive size of files ready to upload in MB, KB or B
private fun getSizeOfFiles(): String {
        val sizeInBytes = navenioManager.getSizeOfFiles()
        val properSize = when {
            sizeInBytes &gt;= SDKConstants.MB_TO_BYTES -&gt; &quot;${sizeInBytes / SDKConstants.MB_TO_BYTES} MB&quot;
            sizeInBytes &gt;= SDKConstants.KB_TO_BYTES -&gt; &quot;${sizeInBytes / SDKConstants.KB_TO_BYTES} KB&quot;
            else -&gt; &quot;$sizeInBytes B&quot;
        }
        return properSize
    }

// You can even observe a list of files, as filenameList is livedata
 navenioManager.filenameList.observe(this, Observer { 
          // Do something when list is modified  
        })
</code></pre>
<h2 id="listeners">Listeners</h2>
<p>With Navenio Manager You can listen for all sorts of events. Here are some examples:</p>
<pre><code class="language-kotlin">// Sampling data are events such as WifiData, BatteryData, CellTowerData etc. 
 val samplingListener = object: SamplingListener&lt;SamplingEvent.DataEvent&gt;(){
            override fun onEvent(event: SamplingEvent.DataEvent) {
                // Do something with Your event
            }
        }
        navenioManager.addDataEventListener(samplingListener)


 // Diagnostic data are events such as WifISamplingStarted, GPSError, GPSStatusChanged etc.
 val diagnosticListener= object: SamplingListener&lt;SamplingEvent.DiagnosticEvent&gt;(){
           override fun onEvent(event: SamplingEvent.DiagnosticEvent) {
               // Do something with Your event
           }
       }
       navenioManager.addDiagnosticEventListener(diagnosticListener)
</code></pre>
<h2 id="login">Login</h2>
<p>.login function is now a coroutine, must be called properly:</p>
<pre><code class="language-kotlin">import kotlinx.coroutines.CoroutineScope
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
class LoginActivity : AppCompatActivity() {

private val scope = CoroutineScope(Dispatchers.Main)

scope.launch{doLogin()}

suspend fun doLogin(username: String, password: String) {...}
}
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../.." class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Welcome to Navenio Android documentation
            </div>
          </div>
        </a>
      
      
        <a href="../SDK_2_Java/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Navenio SDK Java
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.4fa0e4ee.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.1d3bfcf1.min.js"></script>
      
    
  </body>
</html>